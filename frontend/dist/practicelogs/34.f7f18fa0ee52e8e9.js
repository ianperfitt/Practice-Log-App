"use strict";(self.webpackChunkpracticelogs=self.webpackChunkpracticelogs||[]).push([[34],{9034:(J,M,m)=>{m.r(M),m.d(M,{AuthModule:()=>me,localStorageSyncReducer:()=>Q});var j=m(9808),O=m(3075),t=m(5e3);let x=(()=>{class e{constructor(n){if(n)throw new Error("Core module should only be imported to the Root Module")}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(e,12))},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[j.ez]]}),e})();var N=m(8864),d=m(5620),h=(()=>{return(e=h||(h={})).LOGIN="[AUTH] Login",e.SET_TOKEN="[AUTH] Set Token",e.CREATE_USER="[AUTH] Create User",e.LOGIN_ERROR="LOGIN_ERROR",h;var e})();const U=(0,d.PH)(h.SET_TOKEN,(0,d.Ky)()),F=(0,d.PH)(h.LOGIN_ERROR,(0,d.Ky)()),w=(0,d.ZF)("authState");var L=m(8682),A=m(3007),S=m(1271),C=m(9224),i=m(4106),a=m(7531),l=m(7423);function b(e,o){if(1&e&&(t.TgZ(0,"p",8),t._uU(1),t.qZA()),2&e){const n=t.oxw();t.xp6(1),t.hij(" ",n.error," ")}}const y=function(){return["register"]};function Z(e,o){1&e&&(t.TgZ(0,"p",9),t._uU(1,"Create account"),t.qZA()),2&e&&t.Q6J("routerLink",t.DdM(1,y))}const H=function(){return[""]};function W(e,o){1&e&&(t.TgZ(0,"p",9),t._uU(1,"Sign In"),t.qZA()),2&e&&t.Q6J("routerLink",t.DdM(1,H))}let G=(()=>{class e{constructor(n){this.fb=n,this.error="",this.title="Login",this.submitEmitter=new t.vpe,this.form=this.fb.group({email:[""],password:[""]})}submit(){this.submitEmitter.emit(this.form.value)}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(O.qu))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-auth-form"]],inputs:{error:"error",title:"title"},outputs:{submitEmitter:"submitEmitter"},decls:17,vars:6,consts:[["data-cy","auth-title"],[3,"formGroup","ngSubmit"],["class","error",4,"ngIf"],["type","text","matInput","","placeholder","Username","formControlName","email","data-cy","email"],["type","password","matInput","","placeholder","Password","formControlName","password","data-cy","password"],[1,"button"],["type","submit","mat-button","","data-cy","submit-login"],["class","link","routerLinkActive","router-link-active",3,"routerLink",4,"ngIf"],[1,"error"],["routerLinkActive","router-link-active",1,"link",3,"routerLink"]],template:function(n,u){1&n&&(t.TgZ(0,"mat-card")(1,"mat-card-title",0),t._uU(2),t.qZA(),t.TgZ(3,"mat-card-content")(4,"form",1),t.NdJ("ngSubmit",function(){return u.submit()}),t.YNc(5,b,2,1,"p",2),t.TgZ(6,"p")(7,"mat-form-field"),t._UZ(8,"input",3),t.qZA()(),t.TgZ(9,"p")(10,"mat-form-field"),t._UZ(11,"input",4),t.qZA()(),t.TgZ(12,"div",5)(13,"button",6),t._uU(14),t.qZA()(),t.YNc(15,Z,2,2,"p",7),t.YNc(16,W,2,2,"p",7),t.qZA()()()),2&n&&(t.xp6(2),t.Oqu(u.title),t.xp6(2),t.Q6J("formGroup",u.form),t.xp6(1),t.Q6J("ngIf",u.error),t.xp6(9),t.Oqu(u.title),t.xp6(1),t.Q6J("ngIf","Login"==u.title),t.xp6(1),t.Q6J("ngIf","Register"==u.title))},directives:[C.a8,C.n5,C.dn,O._Y,O.JL,O.sg,j.O5,i.KE,a.Nt,O.Fj,O.JJ,O.u,l.lW,A.Od,A.rH],styles:["[_nghost-%COMP%]{display:flex;justify-content:center;margin:100px 0}.mat-form-field[_ngcontent-%COMP%]{width:100%;min-width:300px}mat-card-title[_ngcontent-%COMP%], mat-card-content[_ngcontent-%COMP%]{display:flex;justify-content:center}.error[_ngcontent-%COMP%]{padding:16px;width:300px;color:#fff;background-color:red}.button[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.link[_ngcontent-%COMP%]{cursor:pointer;text-decoration:underline}"]}),e})();const X=[{path:"",component:(()=>{class e{constructor(n,u,f,s){this.store=n,this.authService=u,this.router=f,this._snackBar=s,this.error$=this.store.select((0,d.P1)(w,e=>e.error)),this.checkJWT(),this.getError()}submit(n){this.store.dispatch({type:h.LOGIN,payload:n})}getError(){this.error$.subscribe(n=>{n&&this._snackBar.open(n.message,"Error")})}checkJWT(){this.authService.isAuthenticated()&&this.router.navigate(["/practice-logs"])}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(d.yh),t.Y36(L.i),t.Y36(A.F0),t.Y36(S.ux))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-login"]],decls:1,vars:0,consts:[[3,"submitEmitter"]],template:function(n,u){1&n&&(t.TgZ(0,"app-auth-form",0),t.NdJ("submitEmitter",function(s){return u.submit(s)}),t.qZA())},directives:[G],styles:[""]}),e})()},{path:"register",component:(()=>{class e{constructor(n){this.store=n,this.error=""}ngOnInit(){}submit(n){this.store.dispatch({type:h.CREATE_USER,payload:n})}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(d.yh))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-register"]],decls:1,vars:0,consts:[["title","Register",3,"submitEmitter"]],template:function(n,u){1&n&&(t.TgZ(0,"app-auth-form",0),t.NdJ("submitEmitter",function(s){return u.submit(s)}),t.qZA())},directives:[G],styles:[""]}),e})()}];let V=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[A.Bz.forChild(X)],A.Bz]}),e})();var q=m(4999);const P="@ngrx/store/init",k=/(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})/,ee=(e,o)=>"string"==typeof o&&k.test(o)?new Date(o):o,te=(e,o)=>o;function z(e,o){return o.reduce((n,u)=>{if("string"==typeof u||"number"==typeof u){const f=null==e?void 0:e[u];void 0!==f&&(n[u]=f)}else for(const f in u)Object.prototype.hasOwnProperty.call(u,f)&&(n[f]=z(e[f],u[f]));return n},{})}const ie=(e,o,n,u,f,s)=>{if(s)try{if(!0!==s(e))return}catch(r){if(r instanceof TypeError)return;throw r}o.forEach(r=>{let g,E,v,c=e[r];if("object"==typeof r){let p=Object.keys(r)[0];if(c=e[p],void 0!==c&&r[p]){if(r[p].serialize)c=r[p].serialize(c);else{let T;r[p].reduce?T=r[p]:r[p].filter&&(T=r[p].filter),T&&(c=z(c,T)),r[p].encrypt&&r[p].decrypt?"function"==typeof r[p].encrypt&&(v=r[p].encrypt):(r[p].encrypt||r[p].decrypt)&&console.error(`Either encrypt or decrypt function is not present on '${r[p]}' key object.`)}g=r[p].replacer,E=r[p].space}r=p}if(void 0!==c&&void 0!==n)try{v&&(c=v("string"==typeof c?c:JSON.stringify(c,g,E))),n.setItem(u(r),"string"==typeof c?c:JSON.stringify(c,g,E))}catch(p){console.warn("Unable to save state to localStorage:",p)}else if(void 0===c&&f&&void 0!==n)try{n.removeItem(u(r))}catch(p){console.warn(`Exception on removing/cleaning undefined '${r}' state`,p)}})},se=(e,o,n)=>((n.type===P||"@ngrx/store/update-reducers"===n.type)&&o&&(e=q(e,o,{arrayMerge:(s,r,c)=>r})),e);function K(e,o,n,u,f,s,r){try{var c=e[s](r),g=c.value}catch(E){return void n(E)}c.done?o(g):Promise.resolve(g).then(u,f)}function $(e){return function(){var o=this,n=arguments;return new Promise(function(u,f){var s=e.apply(o,n);function r(g){K(s,u,f,r,c,"next",g)}function c(g){K(s,u,f,r,c,"throw",g)}r(void 0)})}}var R=m(4394),Y=m(5577),ae=m(4004),D=m(8505),B=m(262);let ue=(()=>{class e{constructor(n,u,f){this.actions$=n,this.authService=u,this.router=f,this.loginUser$=(0,R.GW)(()=>this.actions$.pipe((0,R.l4)(h.LOGIN),(0,Y.z)(s=>this.authService.login(s.payload).pipe((0,ae.U)(r=>({type:h.SET_TOKEN,token:r.token})),(0,D.b)(()=>this.router.navigate(["practice-logs"])),(0,B.K)(function(){var r=$(function*(c){return{type:h.LOGIN_ERROR,error:c.error}});return function(c){return r.apply(this,arguments)}}())))),{dispatch:!0}),this.createUser$=(0,R.GW)(()=>this.actions$.pipe((0,R.l4)(h.CREATE_USER),(0,Y.z)(s=>this.authService.register(s.payload).pipe((0,D.b)(()=>this.router.navigate(["login"])),(0,B.K)(function(){var r=$(function*(c){return{type:h.LOGIN_ERROR,error:c.error}});return function(c){return r.apply(this,arguments)}}())))),{dispatch:!1})}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(R.eX),t.LFG(L.i),t.LFG(A.F0))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac}),e})();const fe=(0,d.Lq)({token:"",error:null},(0,d.on)(U,(e,{token:o})=>Object.assign(Object.assign({},e),{token:o})),(0,d.on)(F,(e,{error:o})=>Object.assign(Object.assign({},e),{error:o})));function Q(e){return(e=>o=>{(void 0===e.storage&&!e.checkStorageAvailability||e.checkStorageAvailability&&"undefined"!=typeof window)&&(e.storage=localStorage||window.localStorage),void 0===e.storageKeySerializer&&(e.storageKeySerializer=s=>s),void 0===e.restoreDates&&(e.restoreDates=!0);let n=e.mergeReducer;(void 0===n||"function"!=typeof n)&&(n=se);const u=(e=>e.map(o=>{let n=o;if("object"==typeof o&&(n=Object.keys(o)[0]),"string"!=typeof n)throw new TypeError("localStorageSync Unknown Parameter Type: Expected type of string, got "+typeof n);return o}))(e.keys),f=e.rehydrate?((e,o,n,u)=>e.reduce((f,s)=>{let g,E,r=s,c=u?ee:te;if("object"==typeof r&&(r=Object.keys(r)[0],"function"==typeof s[r]?c=s[r]:(s[r].reviver&&(c=s[r].reviver),s[r].deserialize&&(g=s[r].deserialize)),s[r].encrypt&&s[r].decrypt?"function"==typeof s[r].encrypt&&"function"==typeof s[r].decrypt?E=s[r].decrypt:console.error(`Either encrypt or decrypt is not a function on '${s[r]}' key object.`):(s[r].encrypt||s[r].decrypt)&&console.error(`Either encrypt or decrypt function is not present on '${s[r]}' key object.`)),void 0!==o){let v=o.getItem(n(r));if(v){E&&(v=E(v));const p=new RegExp("{|\\[");let T=v;return("null"===v||"true"===v||"false"===v||p.test(v.charAt(0)))&&(T=JSON.parse(v,c)),Object.assign({},f,{[r]:g?g(T):T})}}return f},{}))(u,e.storage,e.storageKeySerializer,e.restoreDates):void 0;return function(s,r){let c;return c=r.type!==P||s?Object.assign({},s):o(s,r),c=n(c,f,r),c=o(c,r),r.type!==P&&ie(c,u,e.storage,e.storageKeySerializer,e.removeOnUndefined,e.syncCondition),c}})({keys:["token"]})(e)}const pe=[Q];let me=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[j.ez,V,N.q,O.u5,O.UX,x,d.Aw.forFeature("authState",fe,{metaReducers:pe}),R.sQ.forFeature([ue])]]}),e})()},4999:J=>{var M=function(a){return function m(i){return!!i&&"object"==typeof i}(a)&&!function j(i){var a=Object.prototype.toString.call(i);return"[object RegExp]"===a||"[object Date]"===a||function x(i){return i.$$typeof===t}(i)}(a)},t="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function d(i,a){return!1!==a.clone&&a.isMergeableObject(i)?S(function N(i){return Array.isArray(i)?[]:{}}(i),i,a):i}function h(i,a,l){return i.concat(a).map(function(b){return d(b,l)})}function w(i){return Object.keys(i).concat(function F(i){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(i).filter(function(a){return Object.propertyIsEnumerable.call(i,a)}):[]}(i))}function I(i,a){try{return a in i}catch(l){return!1}}function S(i,a,l){(l=l||{}).arrayMerge=l.arrayMerge||h,l.isMergeableObject=l.isMergeableObject||M,l.cloneUnlessOtherwiseSpecified=d;var b=Array.isArray(a);return b===Array.isArray(i)?b?l.arrayMerge(i,a,l):function A(i,a,l){var b={};return l.isMergeableObject(i)&&w(i).forEach(function(y){b[y]=d(i[y],l)}),w(a).forEach(function(y){(function L(i,a){return I(i,a)&&!(Object.hasOwnProperty.call(i,a)&&Object.propertyIsEnumerable.call(i,a))})(i,y)||(b[y]=I(i,y)&&l.isMergeableObject(a[y])?function U(i,a){if(!a.customMerge)return S;var l=a.customMerge(i);return"function"==typeof l?l:S}(y,l)(i[y],a[y],l):d(a[y],l))}),b}(i,a,l):d(a,l)}S.all=function(a,l){if(!Array.isArray(a))throw new Error("first argument should be an array");return a.reduce(function(b,y){return S(b,y,l)},{})},J.exports=S}}]);